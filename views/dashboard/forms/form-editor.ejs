<%- include("../../modules/header.ejs", {
    pageTitle: pageTitle,
    pageDescription: "Editor for Network Forms"
}) %>

<%- include("../../modules/navigationBar.ejs") %>

<%- include("../../partials/miniHeader.ejs", {
  headerTitle: "Forms",
  backgroundImage: globalImage
}) %>

<div class="row dashboardview">
    <div class="col-md-2">
      <%- include("../../modules/dashboard/dashboard-sidebar.ejs") %>
    </div>
    <div class="col-md-10" style="padding: 10px;">
        <%- include("../../partials/documentationLink.ejs", {
            doclink: "https://modularsoft.org/docs/products/zander/features/form/"
        }) %>
        <br><br>
        
        <div class="basic-form">
            <% if (type === 'create') { %>
                <form method="post" action="<%= process.env.siteAddress %>/redirect/form/create">
            <% } %>
            <% if (type === 'edit') { %>
                <form method="post" action="<%= process.env.siteAddress %>/redirect/form/edit">
                    <%- include("../../partials/form/inputHidden.ejs", {
                        elementName: "formId",
                        elementValue: formApiData.formId
                    }) %>
            <% } %>

            <%- include("../../partials/form/inputHidden.ejs", {
                elementName: "actioningUser",
                elementValue: req.session.user.userId
            }) %>
            
            <div class="row">
                <!-- Display Name -->
                <div class="form-group col">
                    <label for="displayName">Display Name</label>

                    <% if (type === 'create') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "displayName",
                            elementValue: null,
                            required: true
                        }) %>
                    <% } %>
                    <% if (type === 'edit') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "displayName",
                            elementValue: formApiData.displayName,
                            required: true
                        }) %>
                    <% } %>
                </div>

                <!-- Form Slug -->
                <div class="form-group col">
                    <label for="formSlug">Form Slug</label>

                    <% if (type === 'create') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "formSlug",
                            elementValue: null,
                            required: true
                        }) %>
                    <% } %>
                    <% if (type === 'edit') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "formSlug",
                            elementValue: formApiData.formSlug,
                            required: true
                        }) %>
                    <% } %>
                </div>

                <!-- Form Type -->
                <div class="form-group col">
                    <label for="formType">Form Type</label>

                    <% if (type === 'create') { %>
                        <select class="form-control" name="formType">
                            <option value="INTERNAL">Internal</option>
                            <option value="EXTERNAL">External</option>
                        </select>
                    <% } %>
                    <% if (type === 'edit') { %>
                        <select class="form-control" name="formType">
                            <option value="INTERNAL" <% if (serverApiData.serverType === 'INTERNAL') { %> selected <% } %>>Internal</option>
                            <option value="EXTERNAL" <% if (serverApiData.serverType === 'EXTERNAL') { %> selected <% } %>>External</option>
                        </select>
                    <% } %>
                </div>
            </div>                                            

            <!-- Form Description -->
            <div class="form-group">
                <label for="description">Form Description</label>

                <% if (type === 'create') { %>
                    <%- include("../../partials/form/inputTextArea.ejs", {
                        elementName: "description",
                        elementValue: null,
                        required: false
                    }) %>
                <% } %>
                <% if (type === 'edit') { %>
                    <%- include("../../partials/form/inputTextArea.ejs", {
                        elementName: "description",
                        elementValue: formApiData.description,
                        required: false
                    }) %>
                <% } %>
            </div>

            <div class="row">
                <!-- Form Schema Link -->
                <div class="form-group col">
                    <label for="formSchema">Form Schema Link</label>
                    <small>If using internal forms, redirect your JSON to a external repository.</small>

                    <% if (type === 'create') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "formSchema",
                            elementValue: null,
                            required: true
                        }) %>
                    <% } %>
                    <% if (type === 'edit') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "formSchema",
                            elementValue: formApiData.formSchema,
                            required: true
                        }) %>
                    <% } %>
                </div>

                <!-- Form URL Redirect -->
                <div class="form-group col">
                    <label for="redirectUrl">Form URL Redirect</label>
                    <small>If using external forms.</small>

                    <% if (type === 'create') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "redirectUrl",
                            elementValue: null,
                            required: false
                        }) %>
                    <% } %>
                    <% if (type === 'edit') { %>
                        <%- include("../../partials/form/inputText.ejs", {
                            elementName: "redirectUrl",
                            elementValue: formApiData.redirectUrl,
                            required: false
                        }) %>
                    <% } %>
                </div>
            </div>

            <div class="row">
                <!-- Form Status -->
                <div class="form-group col">
                    <label for="formStatus">Form Status</label>

                    <% if (type === 'create') { %>
                        <%- include("../../partials/form/inputSelect.ejs", {
                            elementName: "formStatus",
                            elementValue: "null",
                            required: true,
                            optionElements: [
                                {
                                    optionName: "Select a Status",
                                    optionValue: "null",
                                    selected: true,
                                    disabled: true
                                },
                                {
                                    optionName: "Open",
                                    optionValue: "1",
                                    selected: false,
                                    disabled: false
                                },
                                {
                                    optionName: "Closed",
                                    optionValue: "0",
                                    selected: false,
                                    disabled: false
                                }
                            ]
                        }) %>
                    <% } %>
                    <% if (type === 'edit') { %>
                        <%- include("../../partials/form/inputSelect.ejs", {
                            elementName: "formStatus",
                            elementValue: formApiData.formStatus,
                            required: true,
                            optionElements: [
                                {
                                    optionName: "Select a Status",
                                    optionValue: "null",
                                    selected: true,
                                    disabled: true
                                },
                                {
                                    optionName: "Open",
                                    optionValue: "1",
                                    selected: false,
                                    disabled: false
                                },
                                {
                                    optionName: "Closed",
                                    optionValue: "0",
                                    selected: false,
                                    disabled: false
                                }
                            ]
                        }) %>
                    <% } %>
                </div>
            </div>

            <% if (type === 'create') { %>
                <button type="submit" class="btn btn-primary"><i class="fal fa-copy"></i> Create Form</button>
            <% } %>

            <% if (type === 'edit') { %>
                <button type="submit" class="btn btn-warning"><i class="fal fa-copy"></i> Edit Form</button>
            <% } %>
            </form>
        </div>
    </div>
  </div>

<%- include("../../modules/footer.ejs") %>